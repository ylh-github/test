<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
 <mapper namespace="code_fb.mapper.CG_Q002_Mapper" >
 <resultMap id="C001ResultMap" type="code_fb.entity.CG_Q002_C001" >
	 <result column="C_ITEMDES" property="cItemdes" jdbcType="VARCHAR" />
	 <result column="C_ENABLED" property="cEnabled" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMDES" property="cSubitemdes" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMID" property="cSubitemid" jdbcType="VARCHAR" />
	 <result column="C_DEPTOR" property="cDeptor" jdbcType="VARCHAR" />
 </resultMap>
 <resultMap id="C002ResultMap" type="code_fb.entity.CG_Q002_C002" >
	 <result column="C_ITEMDES" property="cItemdes" jdbcType="VARCHAR" />
	 <result column="C_MANOR" property="cManor" jdbcType="VARCHAR" />
	 <result column="C_ENABLED" property="cEnabled" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMDES" property="cSubitemdes" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMID" property="cSubitemid" jdbcType="VARCHAR" />
 </resultMap>
 <resultMap id="C003ResultMap" type="code_fb.entity.CG_Q002_C003" >
	 <result column="C_ITEMDES" property="cItemdes" jdbcType="VARCHAR" />
	 <result column="C_AUDITTYPE" property="cAudittype" jdbcType="VARCHAR" />
	 <result column="C_ENABLED" property="cEnabled" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMDES" property="cSubitemdes" jdbcType="VARCHAR" />
	 <result column="C_SUBITEMID" property="cSubitemid" jdbcType="VARCHAR" />
 </resultMap>
 <resultMap id="M1S1ResultMap" type="code_fb.entity.CG_Q002_M1S1" >
	 <result column="C_DEPTAPPLY" property="cDeptapply" jdbcType="VARCHAR" />
	 <result column="C_DR" property="cDr" jdbcType="VARCHAR" />
	 <result column="C_ID" property="cId" jdbcType="VARCHAR" />
	 <result column="C_AUDITTIME" property="cAudittime" jdbcType="TIMESTAMP" />
	 <result column="C_AUDITTYPE" property="cAudittype" jdbcType="VARCHAR" />
	 <result column="C_COMNAME" property="cComname" jdbcType="VARCHAR" />
	 <result column="C_MODIFYTIME" property="cModifytime" jdbcType="TIMESTAMP" />
	 <result column="C_ORDERNUM" property="cOrdernum" jdbcType="VARCHAR" />
	 <result column="C_AUDITMAN" property="cAuditman" jdbcType="VARCHAR" />
	 <result column="C_CREATETIME" property="cCreatetime" jdbcType="TIMESTAMP" />
	 <result column="C_MANAPPLY" property="cManapply" jdbcType="VARCHAR" />
	 <result column="C_MITTYPE" property="cMittype" jdbcType="VARCHAR" />
	 <result column="C_REMARK" property="cRemark" jdbcType="VARCHAR" />
	 <result column="C_MITMAN" property="cMitman" jdbcType="VARCHAR" />
	 <result column="C_TIMESTAMP" property="cTimestamp" jdbcType="TIMESTAMP" />
	 <result column="C_MITTIME" property="cMittime" jdbcType="TIMESTAMP" />
	 <result column="C_MODIFIER" property="cModifier" jdbcType="VARCHAR" />
	 <result column="C_TIMETAKE" property="cTimetake" jdbcType="VARCHAR" />
	 <result column="C_STATE" property="cState" jdbcType="VARCHAR" />
	 <result column="C_TIMEAPPLY" property="cTimeapply" jdbcType="VARCHAR" />
	 <result column="C_CREATER" property="cCreater" jdbcType="VARCHAR" />
	  <result column="C_MANOR" property="cManor" jdbcType="VARCHAR" />
 </resultMap>
 <resultMap id="S1S2ResultMap" type="code_fb.entity.CG_Q002_S1S2" >
	 <result column="C_MTID" property="cMtid" jdbcType="VARCHAR" />
	 <result column="C_ORDEALLINE" property="cOrdealline" jdbcType="TIMESTAMP" />
	 <result column="C_PHONE" property="cPhone" jdbcType="VARCHAR" />
	 <result column="C_UNIT" property="cUnit" jdbcType="VARCHAR" />
	 <result column="C_DR" property="cDr" jdbcType="VARCHAR" />
	 <result column="C_ID" property="cId" jdbcType="VARCHAR" />
	 <result column="C_MANOR" property="cManor" jdbcType="VARCHAR" />
	 <result column="C_MODIFYTIME" property="cModifytime" jdbcType="TIMESTAMP" />
	 <result column="C_PLANTIME" property="cPlantime" jdbcType="TIMESTAMP" />
	 <result column="C_TYPENAME" property="cTypename" jdbcType="VARCHAR" />
	 <result column="C_CREATETIME" property="cCreatetime" jdbcType="TIMESTAMP" />
	 <result column="C_GOODSNAME" property="cGoodsname" jdbcType="VARCHAR" />
	 <result column="C_REMARK" property="cRemark" jdbcType="VARCHAR" />
	 <result column="C_PLANOR" property="cPlanor" jdbcType="VARCHAR" />
	 <result column="C_POLITIME" property="cPolitime" jdbcType="TIMESTAMP" />
	 <result column="C_TIMESTAMP" property="cTimestamp" jdbcType="TIMESTAMP" />
	 <result column="C_MODIFIER" property="cModifier" jdbcType="VARCHAR" />
	 <result column="C_ALLOTSTATE" property="cAllotstate" jdbcType="VARCHAR" />
	 <result column="C_NO" property="cNo" jdbcType="VARCHAR" />
	 <result column="C_ALLOTMAN" property="cAllotman" jdbcType="VARCHAR" />
	 <result column="C_SPEC" property="cSpec" jdbcType="VARCHAR" />
	 <result column="C_STATE" property="cState" jdbcType="VARCHAR" />
	 <result column="C_MUSTNEED" property="cMustneed" jdbcType="VARCHAR" />
	 <result column="C_NUM" property="cNum" jdbcType="VARCHAR" />
	 <result column="C_POLINORMTIME" property="cPolinormtime" jdbcType="VARCHAR" />
	 <result column="C_ALLOTTIME" property="cAllottime" jdbcType="TIMESTAMP" />
	 <result column="C_ARRTIME" property="cArrtime" jdbcType="TIMESTAMP" />
	 <result column="C_CREATER" property="cCreater" jdbcType="VARCHAR" />
	 <result column="C_DEPTOR" property="cDeptor" jdbcType="VARCHAR" />
 </resultMap>
 <select id="C0011QCG_Q002_C001" parameterType="code_fb.entity.CG_Q002_C001" resultMap="C001ResultMap"> 
  select 
TP_CGAUTHORITY.C_SUBITEMID 
,
TP_CGAUTHORITY.C_ITEMDES 
,
TP_CGAUTHORITY.C_ENABLED 
,
TP_CGAUTHORITY.C_SUBITEMDES 

 from TP_CGAUTHORITY
 WHERE 1=1 
 	AND TP_CGAUTHORITY.C_SUBITEMDES IS NOT NULL
 	AND TP_CGAUTHORITY.C_SUBITEMID IS NOT NULL
   <if test="cItemdes != null" >
       AND  TP_CGAUTHORITY.C_ITEMDES like '' || #{cItemdes,jdbcType=VARCHAR} || ''
  </if>
   <if test="cEnabled != null" >
       AND  TP_CGAUTHORITY.C_ENABLED like '' || #{cEnabled,jdbcType=VARCHAR} || ''
  </if>
	</select> 
 <select id="C0021QCG_Q002_C002" parameterType="code_fb.entity.CG_Q002_C002" resultMap="C002ResultMap"> 
  select 
TP_CGAUTHORITY.C_SUBITEMID 
,
TP_CGAUTHORITY.C_ITEMDES 
,
TP_CGAUTHORITY.C_ENABLED 
,
TP_CGAUTHORITY.C_SUBITEMDES 

 from TP_CGAUTHORITY
 WHERE 1=1 
 	AND TP_CGAUTHORITY.C_SUBITEMDES IS NOT NULL
 	AND TP_CGAUTHORITY.C_SUBITEMID IS NOT NULL
   <if test="cItemdes != null" >
       AND  TP_CGAUTHORITY.C_ITEMDES like '' || #{cItemdes,jdbcType=VARCHAR} || ''
  </if>
   <if test="cEnabled != null" >
       AND  TP_CGAUTHORITY.C_ENABLED like '' || #{cEnabled,jdbcType=VARCHAR} || ''
  </if>
	</select> 
	<select id="C0021QCG_Q002_C003" parameterType="code_fb.entity.CG_Q002_C003" resultMap="C003ResultMap"> 
  select 
TP_CGAUTHORITY.C_SUBITEMID 
,
TP_CGAUTHORITY.C_ITEMDES 
,
TP_CGAUTHORITY.C_ENABLED 
,
TP_CGAUTHORITY.C_SUBITEMDES 

 from TP_CGAUTHORITY
 WHERE 1=1 
 	AND TP_CGAUTHORITY.C_SUBITEMDES IS NOT NULL
 	AND TP_CGAUTHORITY.C_SUBITEMID IS NOT NULL
   <if test="cItemdes != null" >
       AND  TP_CGAUTHORITY.C_ITEMDES like '' || #{cItemdes,jdbcType=VARCHAR} || ''
  </if>
   <if test="cEnabled != null" >
       AND  TP_CGAUTHORITY.C_ENABLED like '' || #{cEnabled,jdbcType=VARCHAR} || ''
  </if>
	</select> 
 <select id="M1S11QCG_Q002_M1S1" parameterType="code_fb.entity.CG_Q002_M1S1" resultMap="M1S1ResultMap"> 
  select distinct
TP_CGORDERMT.C_AUDITMAN 
,
TP_CGORDERMT.C_TIMETAKE 
,
TP_CGORDERMT.C_AUDITTYPE 
,
TP_CGORDERMT.C_COMNAME 
,
TP_CGORDERMT.C_CREATER 
,
TP_CGORDERMT.C_CREATETIME 
,
TP_CGORDERMT.C_DEPTAPPLY 
,
TP_CGORDERMT.C_DR 
,
TP_CGORDERMT.C_ID 
,
TP_CGORDERMT.C_MANAPPLY 
,
TP_CGORDERMT.C_MITMAN 
,
TP_CGORDERMT.C_MITTIME 
,
TP_CGORDERMT.C_MITTYPE 
,
TP_CGORDERMT.C_MODIFIER 
,
TP_CGORDERMT.C_MODIFYTIME 
,
TP_CGORDERMT.C_ORDERNUM 
,
TP_CGORDERMT.C_REMARK 
,
TP_CGORDERMT.C_STATE 
,
TP_CGORDERMT.C_TIMEAPPLY 
,
TP_CGORDERMT.C_TIMESTAMP 
,
TP_CGORDERMT.C_AUDITTIME 

 from TP_CGORDERMT
 WHERE 1=1 
 		 AND TP_CGORDERMT.C_MITTYPE = '1'
	 <if test="cgQ002M1s1.cAudittype != null" >
		 AND  TP_CGORDERMT.C_AUDITTYPE like '%' || #{cgQ002M1s1.cAudittype,jdbcType=VARCHAR} || '%'
  </if>
	 <if test="cgQ002M1s1.cComname != null" >
		 AND  TP_CGORDERMT.C_COMNAME like '%' || #{cgQ002M1s1.cComname,jdbcType=VARCHAR} || '%'
  </if>
	 <if test="cgQ002M1s1.cDeptapply != null" >
		 AND  TP_CGORDERMT.C_DEPTAPPLY like '%' || #{cgQ002M1s1.cDeptapply,jdbcType=VARCHAR} || '%'
  </if>
	 <if test="cgQ002M1s1.cManapply != null" >
		 AND  TP_CGORDERMT.C_MANAPPLY like '%' || #{cgQ002M1s1.cManapply,jdbcType=VARCHAR} || '%'
  </if>
	 <if test="cgQ002M1s1.cOrdernum != null" >
		 AND  TP_CGORDERMT.C_ORDERNUM like '%' || #{cgQ002M1s1.cOrdernum,jdbcType=VARCHAR} || '%'
  </if>
  	 <if test="cgQ002M1s1.startTime != null" >
		 AND  TP_CGORDERMT.C_CREATETIME  &gt;= #{cgQ002M1s1.startTime,jdbcType=TIMESTAMP}
  </if>
  	 <if test="cgQ002M1s1.endTime != null" >
		 AND  TP_CGORDERMT.C_CREATETIME  &lt;=  #{cgQ002M1s1.endTime,jdbcType=TIMESTAMP}
  </if>

	</select> 
	<!-- 分配 -->
	 <update id="S1S22UCG_Q002_S1S2"  >	
		<foreach close=";end;" collection="cgQ002S1s2" index="index" item="item" open="begin" separator=";">  
				        update TP_CGORDERST
				         <set >
				         C_PLANOR = '1',
				 <if test="forMdate.cAllottime != null" >
					C_ALLOTTIME = sysdate,
			  </if>
				 <if test="forMdate.cAllotman != null" >
					C_ALLOTMAN = #{forMdate.cAllotman,jdbcType=VARCHAR},
			  </if>
				 <if test="forMdate.cDeptor != null" >
					C_DEPTOR = #{forMdate.cDeptor,jdbcType=VARCHAR},
			  </if>
				 <if test="forMdate.cManor != null" >
					C_MANOR = #{forMdate.cManor,jdbcType=VARCHAR},
			  </if>
				 <if test="forMdate.cAllotstate != null" >
					C_ALLOTSTATE = '1',
			  </if>
				 <if test="forMdate.cPhone != null" >
					C_PHONE = #{forMdate.cPhone,jdbcType=VARCHAR}
			 </if> 
				 </set> WHERE
				 	C_ID = #{item.cId,jdbcType=VARCHAR}
			       </foreach>
  	</update>
  	<!-- 撤销分配 -->
	 <update id="S1S22MSGCG_Q002_S1S2"  parameterType="java.util.List" >	
	 <foreach close=";end;" collection="cgQ002S1s2" index="index" item="item" open="begin" separator=";">  
	   update TP_CGORDERST
	        set
		C_ALLOTTIME = '',
		C_ALLOTMAN = '',
		C_DEPTOR = '',
		C_MANOR = '',
		C_ALLOTSTATE = '0',
		C_PLANOR = '0',
		C_PHONE = ''
	 	WHERE
	 	C_ID = #{item.cId,jdbcType=VARCHAR}
       </foreach>
  </update>
 </mapper>